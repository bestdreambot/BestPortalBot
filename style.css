(function(){
  const tg = window.Telegram?.WebApp;
  const dbg = m => { const d=document.getElementById('debug'); if(d) d.textContent=m||''; };

  // Экраны/элементы
  const scrLogo   = document.getElementById('screen-logo');
  const scrBest   = document.getElementById('screen-best');
  const scrLunora = document.getElementById('screen-lunora');
  const logo      = document.getElementById('logo');
  const btnLunora = document.getElementById('btnLunora');
  const bestVideo = document.getElementById('bestVideo');
  const lunVideo  = document.getElementById('lunoraVideo');

  // Telegram UI
  try{
    if(tg){
      tg.ready();
      tg.expand();
      tg.setBackgroundColor('#000000');
      tg.setHeaderColor('#000000');
      setTimeout(()=>tg.expand(),120);
    }
  }catch(e){ console.log(e); }

  // Навигация
  function show(el){ [scrLogo,scrBest,scrLunora].forEach(s=>s.classList.remove('active')); el.classList.add('active'); }

  // Шаг 1 -> Шаг 2
  logo.addEventListener('click', ()=>{ show(scrBest); bestVideo.play().catch(()=>{}); });

  // Шаг 2 -> Шаг 3
  btnLunora.addEventListener('click', ()=>{ show(scrLunora); lunVideo.play().catch(()=>{}); });

  // Подстраховка автоплея в iOS
  [bestVideo,lunVideo].forEach(v=>{
    v.muted = true; v.playsInline = true;
    v.addEventListener('loadeddata',()=>v.play().catch(()=>{}));
  });
})();
